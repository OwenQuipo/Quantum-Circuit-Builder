@import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600&family=Fraunces:wght@300;400;500&display=swap");

/* =========================
   Pixel palette + tokens
   ========================= */
:root{
  --bg: #050505;
  --surface: #0d0d0d;
  --surface2: #101010;
  --text: #f4f4f4;
  --muted: #b8b8b8;
  --line: #ffffff22;
  --line-strong: #ffffff44;
  --shadow: rgba(0, 0, 0, 0.65);

  --accent: #fdfdfd;
  --accent-strong: #ffffff;
  --glow: #ffffff33;
  --pixel-grid: rgba(255,255,255,0.04);
  --pixel-grid-strong: rgba(255,255,255,0.08);
  --circuit-wire: #f4f4f4;
  --circuit-wire-faint: #777;
  --circuit-gate-bg: #0f0f0f;
  --circuit-gate-border: #fdfdfd;
  --circuit-gate-glow: #ffffff44;
  --bloch-label: #fdfdfd;
  --pop-cyan: #67d5ff;
  --pop-pink: #ff6fa3;
  --pop-lime: #9dff7a;
  --pop-amber: #ffd36a;
  --pop-blue: #7aa8ff;

  --pad: 14px;
  --gap: 12px;

  --splitLeft: 44%;
  --splitW: 10px;

  --drawerH: 32vh;
  --drawerMinH: 180px;
  --drawerMaxH: 95vh;

  --gateLibW: 360px;
  --blochTileMin: 120px;
}

:root[data-theme="light"]{
  --bg: #f8f8f6;
  --surface: #ffffff;
  --surface2: #ececec;
  --text: #090909;
  --muted: #2f2f2f;
  --line: #00000022;
  --line-strong: #00000040;
  --shadow: rgba(0, 0, 0, 0.14);

  --accent: #0b0b0b;
  --accent-strong: #000000;
  --glow: #00000030;
  --pixel-grid: rgba(0,0,0,0.06);
  --pixel-grid-strong: rgba(0,0,0,0.12);
  --circuit-wire: #0b0b0b;
  --circuit-wire-faint: #555;
  --circuit-gate-bg: #fdfdfd;
  --circuit-gate-border: #0b0b0b;
  --circuit-gate-glow: #00000033;
  --bloch-label: #0b0b0b;
  --pop-cyan: #0086c9;
  --pop-pink: #c91873;
  --pop-lime: #3b8d1f;
  --pop-amber: #b36b00;
  --pop-blue: #2e5fbf;
}

html, body{
  height: 100%;
  margin: 0;
  background: var(--bg);
  color: var(--text);
  overflow: hidden;
  font-family: "Space Grotesk", "Helvetica Neue", Arial, sans-serif;
  letter-spacing: 0.01em;
  font-size: 14px;
  text-transform: none;
}

#qubit-visualizer{
  height: 100vh;
  display: grid;
  grid-template-rows: 58px 1fr;
  gap: var(--gap);
  padding: var(--pad);
  box-sizing: border-box;
  background-image:
    linear-gradient(90deg, var(--pixel-grid) 1px, transparent 1px),
    linear-gradient(0deg, var(--pixel-grid) 1px, transparent 1px);
  background-size: 14px 14px;
}

/* =========================
   Layout
   ========================= */
#topbar{
  height: 58px;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 0 12px;
  background: var(--surface2);
  border-radius: 6px;
  border: 3px solid var(--line-strong);
  box-shadow: 0 0 0 2px var(--line), 6px 6px 0 var(--shadow);
  user-select: none;
}

#title{
  font-size: 0.78rem;
  opacity: 0.82;
  letter-spacing: 0.14em;
}

.spacer{ flex: 1; }

#main{
  display: grid;
  grid-template-columns: minmax(340px, var(--splitLeft)) var(--splitW) minmax(420px, 1fr);
  min-height: 0;
  gap: 0;
}

/* =========================
   Beginner mode layout
   ========================= */
body.beginner-mode #main{
  grid-template-columns: 1fr;
}
body.beginner-mode #primarySplitter,
body.beginner-mode #circuitPane{
  display: none;
}
body.beginner-mode.beginner-show-timeline #primarySplitter,
body.beginner-mode.beginner-show-timeline #circuitPane{
  display: block;
}
body.beginner-mode.beginner-show-timeline #main{
  grid-template-columns: minmax(340px, var(--splitLeft)) var(--splitW) minmax(420px, 1fr);
}
body.beginner-mode #gateLibrary{
  display: none;
}
body.beginner-mode #qubit-visualizer{
  background-image: none;
}

/* =========================
   Quiet mode layout
   ========================= */
body.quiet-mode{
  --bg: #efeee8;
  --surface: transparent;
  --surface2: transparent;
  --text: #1e1d1a;
  --muted: #6f6a63;
  --line: transparent;
  --line-strong: transparent;
  --shadow: transparent;
  --glow: #00000012;
  letter-spacing: 0.015em;
}
body.quiet-mode #qubit-visualizer{
  height: 100vh;
  display: grid;
  grid-template-rows: 1fr;
  padding: 0;
  gap: 0;
  background-image: none;
}
body.quiet-mode #topbar,
body.quiet-mode #primarySplitter,
body.quiet-mode #backendDrawer,
body.quiet-mode #probPopover,
body.quiet-mode #overlayBackdrop,
body.quiet-mode #settingsPanel,
body.quiet-mode #beginnerPanel,
body.quiet-mode #blochRevealOverlay,
body.quiet-mode #blochOverlay,
body.quiet-mode #correlationsPanel,
body.quiet-mode #entanglementBadge{
  display: none !important;
}
body.quiet-mode #gateLibrary,
body.quiet-mode #primarySplitter,
body.quiet-mode #circuitPane{
  display: none !important;
}
body.quiet-mode #main{
  grid-template-columns: 1fr;
  min-height: 100%;
}
body.quiet-mode.quiet-show-circuit #main{
  grid-template-columns: 1fr;
  grid-template-rows: 1fr;
  align-content: stretch;
  position: relative;
}
body.quiet-mode .pane{
  background: transparent;
  border: none;
  box-shadow: none;
  padding: 0;
}
body.quiet-mode #blochPane{
  display: flex;
}
body.quiet-mode #blochCanvas{
  padding: 0;
  overflow: hidden;
  background-image: none;
  display: grid;
  place-items: center;
}
body.quiet-mode #blochPane{
  display: grid;
  grid-template-rows: 1fr auto;
  align-items: center;
}
body.quiet-mode.quiet-show-circuit #blochPane{
  grid-template-rows: 1fr;
}
body.quiet-mode #bloch-grid{
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0;
  opacity: 1 !important;
  filter: none !important;
  pointer-events: auto;
}
body.quiet-mode .bloch-tile{
  display: flex;
  align-items: center;
  justify-content: center;
}
body.quiet-mode .bloch-tile{
  background: transparent;
  border: none;
  box-shadow: none;
  padding: 0;
  min-height: auto;
}
body.quiet-mode .bloch-tile-header,
body.quiet-mode .purity-chip,
body.quiet-mode .measurement-badge,
body.quiet-mode .state-chip{
  display: none !important;
}
body.quiet-mode .tile-canvas{
  background: transparent;
  border: none;
  border-radius: 0;
  box-shadow: none;
  width: clamp(220px, 62vmin, 460px);
  height: clamp(220px, 62vmin, 460px);
  aspect-ratio: 1 / 1;
}
body.quiet-mode .tile-canvas canvas{
  background: transparent;
  pointer-events: auto;
  touch-action: auto;
}

.pane{
  min-height: 0;
  border-radius: 6px;
  background: var(--surface);
  position: relative;
  overflow: hidden;
  padding: 6px;
  box-sizing: border-box;
  border: 3px solid var(--line-strong);
  box-shadow: 0 0 0 2px var(--line), 6px 6px 0 var(--shadow);
}

/* =========================
   Splitter
   ========================= */
.splitter{
  cursor: col-resize;
  user-select: none;
  touch-action: none;
  position: relative;
  background: repeating-linear-gradient(
    0deg,
    var(--pixel-grid-strong),
    var(--pixel-grid-strong) 4px,
    transparent 4px,
    transparent 8px
  );
}
.splitter::before{
  content: "";
  position: absolute;
  top: 10px;
  bottom: 10px;
  left: 50%;
  width: 12px;
  transform: translateX(-50%);
  background:
    repeating-linear-gradient(0deg, var(--accent-strong), var(--accent-strong) 2px, transparent 2px, transparent 4px);
  opacity: 0.2;
}
body.split-dragging .splitter::before{ opacity: 0.45; }

/* =========================
   Buttons (pixel slabs)
   ========================= */
.icon-btn{
  height: 36px;
  min-width: 36px;
  padding: 0 12px;
  border-radius: 4px;
  border: 2px solid var(--line-strong);
  background: var(--surface);
  color: var(--text);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  cursor: pointer;
  box-shadow: 0 0 0 2px var(--line), 4px 4px 0 var(--shadow);
}
.icon-btn:hover{
  background: var(--surface2);
  box-shadow: 0 0 0 2px var(--accent-strong), 4px 4px 0 var(--shadow);
}
.icon-btn[disabled]{ opacity: 0.35; cursor: default; box-shadow: none; }

.ico{ font-size: 0.95rem; line-height: 1; opacity: 0.92; }

.step-controls{
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.step-counter{
  font-size: 0.70rem;
  color: var(--text);
  padding: 0 12px;
  height: 34px;
  display: inline-flex;
  align-items: center;
  border-radius: 4px;
  background: var(--surface2);
  border: 2px solid var(--line-strong);
  box-shadow:
    0 0 0 2px var(--line),
    4px 4px 0 var(--shadow),
    0 0 0 2px var(--accent-strong) inset;
  letter-spacing: 0.04em;
}

.qubit-controls{
  display: inline-flex;
  align-items: center;
  gap: 6px;
}
